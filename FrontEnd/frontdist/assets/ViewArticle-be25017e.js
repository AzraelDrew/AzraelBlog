import{_ as j,o as x,c as h,f as e,D as E,d as ae,a as oe,b as le,J as ie,u as re,K as ce,i as d,I as ue,j as de,r as m,g as n,v as me,h as l,l as o,R as T,t as i,k as U,y as W,z as pe,T as fe,n as F,L as _e,M as ve,F as R,e as ke,E as w,p as we,q as xe}from"./index-734f478a.js";import{a as p,T as b,b as ye}from"./TheNavBar-9c4d3f25.js";import{T as ge}from"./TheButton-6961f5fb.js";const be={},he={class:"grid comment"};function Ce(f,v){return x(),h("div",he,[e("div",null,[E(f.$slots,"avatar")]),e("div",null,[E(f.$slots,"articleContent")])])}const Ne=j(be,[["render",Ce]]),G=f=>(we("data-v-ae7beb69"),f=f(),xe(),f),Se={class:"el-dropdown-link flex"},Ie=G(()=>e("span",null,"个人信息",-1)),ze=G(()=>e("span",null,"退出登录",-1)),Te={key:1},De={class:"flex"},Be={class:"article"},Ve={style:{"margin-left":"40px"}},Ae={class:"flex flexJustifyStart"},$e={style:{display:"flex","align-content":"center"}},Le={class:"flex flexJustifyStart"},Je={class:"flex"},Ee={class:"md"},Ue={class:"articleButton iconButton flex flexWarp flexJustifySpaceEvenly"},We={class:"flex flexJustifySpaceBetween"},Fe={class:"flex flexJustifySpaceBetween"},Re={class:"flex flexWarp iconAdnButton",style:{"align-items":"start"}},je={class:"flex flexJustifySpaceBetween iconAdnButton",style:{margin:"10px 20px 0px 20px"}},Ge={class:"grid commentTitle"},Ke={style:{"margin-bottom":"10px"}},Me=["onClick"],qe={style:{display:"flex","justify-content":"end"}},He={class:"grid comment"},Oe={class:"grid commentTitle"},Pe={style:{"margin-bottom":"10px"}},Qe={class:"commentDetail"},Xe=ae({__name:"ViewArticle",setup(f){const v=oe(),C=le(),y=ie(),r=re(),D=ce(()=>document.body.clientWidth<500?300:"40%"),N=d(!1),S=d(!1),K=d(""),s=ue({id:"",belongUser:"0",title:"",content:"",nickeName:"",date:"",avatar:"",viewNumber:0,commentNumber:0,likeNumber:0,favouriteNumber:0,favorStatus:!1,likeStatus:!1}),g=d(""),B=d(),V=d(""),A=d(""),$=d(""),I=d("");function M(){w({title:"Success",message:"复制成功",type:"success"})}de(async()=>{let t=(await v({url:"api/article/?id="+y.params.id+"&userId="+r.userInfo.id,method:"GET"})).data;s.id=t.id,s.belongUser=t.belongUser,K.value=t.content,s.avatar=t.avatar,s.nickeName=t.nickName,s.date=t.date,s.title=t.title,s.content=t.content,s.commentNumber=t.commentNumber,s.favouriteNumber=t.favouriteNumber,s.likeNumber=t.likeNumber,s.viewNumber=t.viewNumber,s.likeStatus=t.likeStatus,s.favorStatus=t.favorStatus});async function q(c){C.push({name:"EditArticle",params:{id:y.params.id}})}async function z(){N.value=!0;let c=await v({url:"api/comment/?id="+y.params.id,method:"GET"});B.value=c.data.data}async function H(c){let t=new FormData;t.append("id",c),t.append("userId",r.userInfo.id),(await v.post("api/delete/comment/",t)).data=="OK"?(w({title:"Success",message:"删除成功",type:"success"}),z()):w({title:"Warning",message:"不能删除他人的评论",type:"warning"})}async function O(c,t){if(!r.userInfo.token)w({title:"Warning",message:"请登录",type:"warning"});else if(g.value=="")w({title:"Warning",message:"评论不能为空",type:"warning"});else{let u=new FormData;u.append("id",c),u.append("userId",t),u.append("text",g.value),await v.post("api/add/comment/",u),g.value="",z()}}function P(c,t,u,_){S.value=!0,V.value=c,A.value=t,$.value=u,I.value=_}function Q(){C.replace({name:"Login"})}function X(){r.userLogout(),C.replace({name:"Home"})}async function L(c,t,u){if(!r.userInfo.token)w({title:"Warning",message:"请登录",type:"warning"});else{let _=await v({url:"/api/article/"+c+"/?id="+t+"&userId="+u,method:"GET"});console.log(_.data);let k=_.data;c=="like"?(k.status?s.likeNumber+=1:s.likeNumber-=1,s.likeStatus=k.status):(k.status?s.favouriteNumber+=1:s.favouriteNumber-=1,s.favorStatus=k.status)}}return(c,t)=>{const u=m("el-icon"),_=m("el-dropdown-item"),k=m("el-dropdown-menu"),Y=m("el-dropdown"),Z=m("v-md-preview"),ee=m("el-input"),te=m("el-button"),J=m("el-drawer");return x(),h(R,null,[n(ye,null,me({avatarAndNickname:o(()=>[n(l(T),{class:"flex link linkColor",to:"/"},{default:o(()=>[n(b,{size:40,src:l(r).userInfo.avatar},null,8,["src"]),e("span",null,i(l(r).userInfo.name),1)]),_:1})]),dropDown:o(()=>[l(r).isLogin?(x(),U(Y,{key:0},{dropdown:o(()=>[n(k,{class:"dropDown"},{default:o(()=>[n(_,{command:"a"},{default:o(()=>[n(l(T),{class:"flex link linkColor",to:"/profile"},{default:o(()=>[Ie,n(p,{icon:"iconmy",size:18})]),_:1})]),_:1}),n(_,{command:"b",onClick:X},{default:o(()=>[ze,n(p,{icon:"iconlogout",size:18})]),_:1})]),_:1})]),default:o(()=>[e("span",Se,[W(" 个人中心"),n(u,{class:"el-icon--right"},{default:o(()=>[n(l(pe))]),_:1})])]),_:1})):(x(),h("div",Te,[e("a",{class:"link linkColor",onClick:Q},"登录")]))]),_:2},[l(r).isLogin?{name:"postIcon",fn:o(()=>[n(l(T),{to:"/postArticle",class:"link linkColor postArticle"},{default:o(()=>[n(p,{icon:"iconbianji4",size:25})]),_:1})]),key:"0"}:void 0]),1024),e("div",De,[n(fe,{name:"fade",appear:""},{default:o(()=>[e("div",Be,[e("div",Ve,[e("h2",null,i(s.title),1),e("div",Ae,[n(b,{size:40,src:s.avatar},null,8,["src"]),e("span",$e,i(s.nickeName),1)]),e("div",Le,[e("p",null,"发布于:"+i(s.date.split("T")[0]),1),e("div",Je,[n(p,{icon:"iconview",size:25}),e("p",null,i(s.viewNumber||""),1)])])]),e("div",Ee,[n(Z,{text:s.content,"default-show-toc":!0,onCopyCodeSuccess:M},null,8,["text"])])])]),_:1}),e("div",Ue,[e("div",We,[n(p,{icon:"icondianzan",class:F({likeFavor:s.likeStatus}),size:30,onClick:t[0]||(t[0]=a=>L("like",l(y).params.id,l(r).userInfo.id))},null,8,["class"]),e("p",null,i(s.likeNumber||""),1)]),e("div",Fe,[n(p,{icon:"iconshoucang5",class:F({likeFavor:s.favorStatus}),size:30,onClick:t[1]||(t[1]=a=>L("favor",l(y).params.id,l(r).userInfo.id))},null,8,["class"]),e("p",null,i(s.favouriteNumber||""),1)]),e("div",{class:"flex flexJustifySpaceBetween",onClick:t[2]||(t[2]=a=>z())},[n(p,{icon:"iconpinglun2",size:25}),e("p",null,i(s.commentNumber||""),1)]),_e(e("div",{class:"flex flexJustifySpaceBetween",onClick:t[3]||(t[3]=a=>q(s.id))},[n(p,{icon:"iconedit_light",size:25})],512),[[ve,l(r).userInfo.id==s.belongUser]])]),n(J,{modelValue:N.value,"onUpdate:modelValue":t[6]||(t[6]=a=>N.value=a),title:"评论"+s.commentNumber,direction:"rtl",size:l(D)},{default:o(()=>[e("div",Re,[n(ee,{class:"input",modelValue:g.value,"onUpdate:modelValue":t[4]||(t[4]=a=>g.value=a),type:"textarea",rows:8,placeholder:"Please input"},null,8,["modelValue"]),e("div",je,[n(b,{size:40,src:l(r).userInfo.avatar},null,8,["src"]),n(te,{type:"primary",onClick:t[5]||(t[5]=a=>O(s.id,l(r).userInfo.id))},{default:o(()=>[W("发布评论")]),_:1})])]),(x(!0),h(R,null,ke(B.value,(a,se)=>(x(),U(Ne,{key:se},{avatar:o(()=>[n(b,{size:40,isCommentContent:!0,src:a.avatar},null,8,["src"])]),articleContent:o(()=>[e("div",Ge,[e("h4",null,i(a.nickName),1),e("p",null,i(a.date.split("T")[0])+" "+i(a.date.split("T")[1].split(".")[0]),1)]),e("div",Ke,[e("p",{class:"commentContent",onClick:ne=>P(a.text,a.avatar,a.nickName,a.date)},i(a.text),9,Me),e("div",qe,[n(ge,{text:"删除",style:{display:"flex"},onClick:ne=>H(a.id)},null,8,["onClick"])])])]),_:2},1024))),128))]),_:1},8,["modelValue","title","size"]),n(J,{modelValue:S.value,"onUpdate:modelValue":t[7]||(t[7]=a=>S.value=a),title:"评论",direction:"ltr",size:l(D)},{default:o(()=>[e("div",He,[e("div",null,[n(b,{size:40,isCommentContent:!0,src:A.value},null,8,["src"])]),e("div",null,[e("div",Oe,[e("h4",null,i($.value),1),e("p",null,i(I.value.split("T")[0])+" "+i(I.value.split("T")[1].split(".")[0]),1)]),e("div",Pe,[e("p",Qe,i(V.value),1)])])])]),_:1},8,["modelValue","size"])])],64)}}});const tt=j(Xe,[["__scopeId","data-v-ae7beb69"]]);export{tt as default};
