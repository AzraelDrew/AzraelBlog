import{_ as W,o as y,c as C,f as t,A as U,d as le,a as ae,b as ie,G as ce,u as re,H as ue,i as m,D as de,j as me,r as p,g as o,v as pe,h as a,l,R as T,t as i,k as E,x as F,y as fe,T as _e,n as R,I as ve,J as ke,F as j,e as xe,E as b,p as ye,q as ge}from"./index-12433a3f.js";import{a as f,T as g,b as we}from"./TheNavBar-29ea6621.js";import{T as G}from"./TheButton-a372b650.js";const he={},be={class:"grid comment"};function Ce(_,k){return y(),C("div",be,[t("div",null,[U(_.$slots,"avatar")]),t("div",null,[U(_.$slots,"articleContent")])])}const Ne=W(he,[["render",Ce]]),q=_=>(ye("data-v-0f366866"),_=_(),ge(),_),Se={class:"el-dropdown-link flex"},Ie=q(()=>t("span",null,"个人信息",-1)),ze=q(()=>t("span",null,"退出登录",-1)),Te={key:1},De={class:"flex"},Ve={class:"article"},Ae={style:{"margin-left":"40px"}},Be={class:"flex flexJustifyStart"},$e={style:{display:"flex","align-content":"center"}},Le={class:"flex flexJustifyStart"},Je={class:"flex"},Ue={class:"md"},Ee={class:"iconButton flex flexWarp flexJustifySpaceEvenly"},Fe={class:"flex flexJustifySpaceBetween"},Re={class:"flex flexJustifySpaceBetween"},je={class:"flex flexWarp iconAdnButton",style:{"align-items":"start"}},Ge={class:"flex flexJustifySpaceBetween iconAdnButton",style:{margin:"10px 20px 0px 20px"}},We={class:"grid commentTitle"},qe={style:{"margin-bottom":"10px"}},He=["onClick"],Ke={style:{display:"flex","justify-content":"end"}},Me={class:"grid comment"},Oe={class:"grid commentTitle"},Pe={style:{"margin-bottom":"10px"}},Qe={class:"commentDetail"},Xe={style:{display:"flex","justify-content":"end"}},Ye=le({__name:"ViewArticle",setup(_){const k=ae(),w=ie(),v=ce(),r=re(),D=ue(()=>document.body.clientWidth<500?300:"40%"),N=m(!1),S=m(!1),H=m(""),s=de({id:"",belongUser:"0",title:"",content:"",nickeName:"",date:"",avatar:"",viewNumber:0,commentNumber:0,likeNumber:0,favouriteNumber:0,favorStatus:!1,likeStatus:!1}),h=m(""),V=m(),A=m(""),B=m(""),$=m(""),I=m("");function K(){b({title:"Success",message:"复制成功",type:"success"})}me(async()=>{console.log(v.params),console.log(w.currentRoute.value),console.log(v.params);let e=(await k({url:"api/article/?id="+v.params.id+"&userId="+r.userInfo.id,method:"GET"})).data;console.log("article",e),console.log(typeof e.belongUser),s.id=e.id,s.belongUser=e.belongUser,H.value=e.content,s.avatar=e.avatar,s.nickeName=e.nickName,s.date=e.date,s.title=e.title,s.content=e.content,s.commentNumber=e.commentNumber,s.favouriteNumber=e.favouriteNumber,s.likeNumber=e.likeNumber,s.viewNumber=e.viewNumber,s.likeStatus=e.likeStatus,s.favorStatus=e.favorStatus,console.log(s)});async function M(c){w.push({name:"EditArticle",params:{id:v.params.id}})}async function z(){N.value=!0;let c=await k({url:"api/comment/?id="+v.params.id,method:"GET"});console.log(c),V.value=c.data.data}async function O(c){console.log(c);let e=new FormData;e.append("id",c),e.append("userId",r.userInfo.id);let u=await k.post("api/delete/comment/",e);console.log(u.data),u.data=="OK"&&(b({title:"Success",message:"删除成功",type:"success"}),z())}async function P(c,e){if(!r.userInfo.token)b({title:"Success",message:"请登录",type:"success"});else{let u=new FormData;u.append("id",c),u.append("userId",e),u.append("text",h.value);let d=await k.post("api/add/comment/",u);h.value="",z(),console.log(d)}}function Q(c,e,u,d){S.value=!0,A.value=c,B.value=e,$.value=u,I.value=d}function X(){w.replace({name:"Login"})}function Y(){r.userLogout(),w.replace({name:"Login"})}async function L(c,e,u){if(!r.userInfo.token)b({title:"Success",message:"请登录",type:"success"});else{let d=await k({url:"/api/article/"+c+"/?id="+e+"&userId="+u,method:"GET"});console.log(d.data);let x=d.data;c=="like"?(x.status?s.likeNumber+=1:s.likeNumber-=1,s.likeStatus=x.status):(x.status?s.favouriteNumber+=1:s.favouriteNumber-=1,s.favorStatus=x.status)}}return(c,e)=>{const u=p("el-icon"),d=p("el-dropdown-item"),x=p("el-dropdown-menu"),Z=p("el-dropdown"),ee=p("v-md-preview"),te=p("el-input"),se=p("el-button"),J=p("el-drawer");return y(),C(j,null,[o(we,null,pe({avatarAndNickname:l(()=>[o(a(T),{class:"flex link linkColor",to:"/"},{default:l(()=>[o(g,{size:40,src:a(r).userInfo.avatar},null,8,["src"]),t("span",null,i(a(r).userInfo.name),1)]),_:1})]),dropDown:l(()=>[a(r).isLogin?(y(),E(Z,{key:0},{dropdown:l(()=>[o(x,{class:"dropDown"},{default:l(()=>[o(d,{command:"a"},{default:l(()=>[o(a(T),{class:"flex link linkColor",to:"/profile"},{default:l(()=>[Ie,o(f,{icon:"iconmy",size:18})]),_:1})]),_:1}),o(d,{command:"b",onClick:Y},{default:l(()=>[ze,o(f,{icon:"iconlogout",size:18})]),_:1})]),_:1})]),default:l(()=>[t("span",Se,[F(" 个人中心"),o(u,{class:"el-icon--right"},{default:l(()=>[o(a(fe))]),_:1})])]),_:1})):(y(),C("div",Te,[t("a",{class:"link linkColor",onClick:X},"登录")]))]),_:2},[a(r).isLogin?{name:"postIcon",fn:l(()=>[o(a(T),{to:"/postArticle",class:"link linkColor postArticle"},{default:l(()=>[o(f,{icon:"iconbianji4",size:25})]),_:1})]),key:"0"}:void 0]),1024),t("div",De,[o(_e,{name:"fade",appear:""},{default:l(()=>[t("div",Ve,[t("div",Ae,[t("h2",null,i(s.title),1),t("div",Be,[o(g,{size:40,src:s.avatar},null,8,["src"]),t("span",$e,i(s.nickeName),1)]),t("div",Le,[t("p",null,"发布于:"+i(s.date.split("T")[0]),1),t("div",Je,[o(f,{icon:"iconview",size:25}),t("p",null,i(s.viewNumber||""),1)])])]),t("div",Ue,[o(ee,{text:s.content,"default-show-toc":!0,onCopyCodeSuccess:K},null,8,["text"])])])]),_:1}),t("div",Ee,[t("div",Fe,[o(f,{icon:"icondianzan",class:R({likeFavor:s.likeStatus}),size:30,onClick:e[0]||(e[0]=n=>L("like",a(v).params.id,a(r).userInfo.id))},null,8,["class"]),t("p",null,i(s.likeNumber||""),1)]),t("div",Re,[o(f,{icon:"iconshoucang5",class:R({likeFavor:s.favorStatus}),size:30,onClick:e[1]||(e[1]=n=>L("favor",a(v).params.id,a(r).userInfo.id))},null,8,["class"]),t("p",null,i(s.favouriteNumber||""),1)]),t("div",{class:"flex flexJustifySpaceBetween",onClick:e[2]||(e[2]=n=>z())},[o(f,{icon:"iconpinglun2",size:25}),t("p",null,i(s.commentNumber||""),1)]),ve(t("div",{class:"flex flexJustifySpaceBetween",onClick:e[3]||(e[3]=n=>M(s.id))},[o(f,{icon:"iconedit_light",size:25})],512),[[ke,a(r).userInfo.id==s.belongUser]])]),o(J,{modelValue:N.value,"onUpdate:modelValue":e[6]||(e[6]=n=>N.value=n),title:"评论"+s.commentNumber,direction:"rtl",size:a(D)},{default:l(()=>[t("div",je,[o(te,{class:"input",modelValue:h.value,"onUpdate:modelValue":e[4]||(e[4]=n=>h.value=n),type:"textarea",rows:8,placeholder:"Please input"},null,8,["modelValue"]),t("div",Ge,[o(g,{size:40,src:a(r).userInfo.avatar},null,8,["src"]),o(se,{type:"primary",onClick:e[5]||(e[5]=n=>P(s.id,a(r).userInfo.id))},{default:l(()=>[F("发布评论")]),_:1})])]),(y(!0),C(j,null,xe(V.value,(n,oe)=>(y(),E(Ne,{key:oe},{avatar:l(()=>[o(g,{size:40,isCommentContent:!0,src:n.avatar},null,8,["src"])]),articleContent:l(()=>[t("div",We,[t("h4",null,i(n.nickName),1),t("p",null,i(n.date.split("T")[0])+" "+i(n.date.split("T")[1].split(".")[0]),1)]),t("div",qe,[t("p",{class:"commentContent",onClick:ne=>Q(n.text,n.avatar,n.nickName,n.date)},i(n.text),9,He),t("div",Ke,[o(G,{text:"删除",style:{display:"flex"},onClick:ne=>O(n.id)},null,8,["onClick"])])])]),_:2},1024))),128))]),_:1},8,["modelValue","title","size"]),o(J,{modelValue:S.value,"onUpdate:modelValue":e[7]||(e[7]=n=>S.value=n),title:"评论",direction:"ltr",size:a(D)},{default:l(()=>[t("div",Me,[t("div",null,[o(g,{size:40,isCommentContent:!0,src:B.value},null,8,["src"])]),t("div",null,[t("div",Oe,[t("h4",null,i($.value),1),t("p",null,i(I.value.split("T")[0])+" "+i(I.value.split("T")[1].split(".")[0]),1)]),t("div",Pe,[t("p",Qe,i(A.value),1),t("div",Xe,[o(G,{text:"删除",style:{display:"flex"}})])])])])]),_:1},8,["modelValue","size"])])],64)}}});const st=W(Ye,[["__scopeId","data-v-0f366866"]]);export{st as default};
